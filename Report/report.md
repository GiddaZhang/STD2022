# 噪声干扰下的音视频匹配设计报告

[TOC]

文件清单:

| 文件名             | 文件说明                               |
| ------------------ | -------------------------------------- |
| part1.ipynb        | 任务一代码                             |
| part2.ipynb        | 任务二代码                             |
| Vfeat_extracter.py | 任务三（下省略）视频特征提取           |
| Vfeat_pca.py       | 视频特征降维                           |
| Afeat_ectracter.py | 音频特征提取                           |
| v_denoise_feat.py  | 视频降噪 + 特征提取                    |
| a_denoise_feat.py  | 音频降噪 + 特征提取                    |
| similarity_test.py | 检验输入特征的相关度                   |
| dataset.py         | 数据加载                               |
| models.py          | 网络模型                               |
| train.py           | 训练网络                               |
| test.py            | 测试网络                               |
| train_test.py      | 同时实现训练、测试网络得到批量测试结果 |





## 任务一：基于滤波器的图像噪声处理

我们根据指导书实现了均值滤波器、高斯滤波器，并将两种图像去噪方法分别应用在两张含有不同种类噪声的图片上，进行对比分析。

![img1](.\imgs\Task1\img1.png)

### 图像去噪比较

#### 按照滤波器不同比较

由两种方法得到的两种滤波结果可以看到，对于两种图片，均值滤波器和高斯滤波器结果相近

#### 按照图片不同比较

将图中从外向内三个区域编号为1、2、3，则：

- 图一中区域1去噪效果较好，区域2一般，区域3较差；
- 图二中区域1去噪效果较差，区域2一般，区域3较好

### 分析
#### 图片1
图一噪声幅度较小，区域颜色与噪声颜色相近程度为区域1 > 区域2 > 区域3，所以在区域1滤波效果较好，区域3滤波效果较差。
#### 图片2
图而噪声幅度较大，区域颜色与噪声颜色相近程度为区域3 > 区域2 > 区域1，所以在区域3滤波效果较好，区域1滤波效果较差。
### 中值滤波结果分析

针对图二，该图所带噪声为比较明显的椒盐噪声，使用中值滤波可以有效消除。

![img2](.\imgs\Task1\img2.png)

## 任务二：基于谱减法的音频噪声处理

我们根据指导书实现了使用谱减法对带噪声音频的处理，在音频前5帧只含有噪声的先验假设下得到结果波形图如下所示：

![wave](.\imgs\Task2\wave.png)

可以观察到处理后（下）相较于处理前（上）在保持音频原有波形的基础上减弱了噪声波形，经过实际播放验证，音频降噪成功。

## 任务三：音视频匹配

### 基本原理

#### 视频特征

- 对视频每1秒提取1帧图像，每个视频共10帧图像，每帧图像均送入特征提取网络，得到一个2048维$(1\times2048)$的特征数据，则一个视频得到$(10\times2048)$的特征
- 对前述得到的特征提取512维主成分，每视频最终产生$(10\times512)$的特征。

#### 音频特征

- 对每条音频划分出10帧，每帧生成128维特征，最终每条音频产生$(10\times128)$的特征。

#### 网络结构：TODO

### 子任务一：清晰音视频匹配：

#### 数据集划分

使用Train中Clean的音视频产生的特征作为训练、数据集。其中随机选取50对音视频作为测试集，剩余的作为训练集。

#### 训练 - 测试结果

经过100轮训练，得到：

- 在50条数据的测试集上Top1准确率为: 0.26892。
- 在50条数据的测试集上Top5准确率为: 0.77008。

#### 分析

比对Top1匹配结果的音视频，可以发现清晰音视频匹配的结果基本正确，虽然Top1准确率只有不到27%，但由于数据集本身的音视频（尤其是音频）存在及格明显的分类，而类内相似度比较高，导致作为人类也无法准确判断语音视频是否匹配，只能准确地判断音视频是否同属于一类。

### 子任务二：带噪音视频匹配：

#### 数据集划分

考虑到Train中未给出带噪声的音视频，我们使用Train中清晰的音视频生成了带噪声的音视频特征，并对特征划分训练集、数据集。其中随机选取50对音视频作为测试集，剩余的作为训练集。

#### 数据集降噪

###### 视频

考虑到视频特征提取时仅适用视频的10帧图像，因此直接在提取特征之前对图像降噪即可，降噪使用`OpenCV`自带的方法`fastNlMeansDenoisingColored()`。

###### 音频

- 所有带噪音频降噪并保存
- 读取所有降噪音频生成降噪音频特征

#### 训练 - 测试结果

经过？轮训练，得到：

- 在？条数据的测试集上Top1准确率为: ？。
- 在？条数据的测试集上Top5准确率为: ？。

#### 分析



## TODO

- [ ] 小组成员名单及分工
- [ ] 网络结构
- [ ] 训练结果对比
- [ ] 内容优化